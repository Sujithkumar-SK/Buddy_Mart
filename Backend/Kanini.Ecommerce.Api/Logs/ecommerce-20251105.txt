2025-11-05 12:06:40.224 +05:30 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'RefreshToken'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-11-05 12:10:01.987 +05:30 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'RefreshToken'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-11-05 12:10:20.072 +05:30 [INF] Executed DbCommand (13,246ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [Vendor_Ecommerce];
2025-11-05 12:10:21.224 +05:30 [INF] Executed DbCommand (1,139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [Vendor_Ecommerce] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-11-05 12:10:21.389 +05:30 [INF] Executed DbCommand (133ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-05 12:10:21.415 +05:30 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-11-05 12:10:21.861 +05:30 [INF] Executed DbCommand (429ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-11-05 12:10:22.083 +05:30 [INF] Executed DbCommand (69ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-11-05 12:10:22.138 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-11-05 12:10:22.148 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-11-05 12:10:22.330 +05:30 [INF] Executed DbCommand (164ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-11-05 12:10:22.376 +05:30 [INF] Applying migration '20251105063643_InitialCreate'.
2025-11-05 12:10:23.391 +05:30 [INF] Executed DbCommand (692ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [CategoryId] int NOT NULL IDENTITY,
    [Name] NVARCHAR(100) NOT NULL,
    [Description] NVARCHAR(500) NULL,
    [ImagePath] NVARCHAR(500) NULL,
    [IsActive] BIT NOT NULL,
    [ParentCategoryId] int NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([CategoryId]),
    CONSTRAINT [FK_Categories_Categories_ParentCategoryId] FOREIGN KEY ([ParentCategoryId]) REFERENCES [Categories] ([CategoryId]) ON DELETE NO ACTION
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Product categories with hierarchical support';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Categories';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Categories', 'COLUMN', N'TenantId';
2025-11-05 12:10:23.463 +05:30 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [SubscriptionPlans] (
    [PlanId] int NOT NULL IDENTITY,
    [PlanName] NVARCHAR(100) NOT NULL,
    [Description] NVARCHAR(500) NULL,
    [Price] DECIMAL(18,2) NOT NULL,
    [MaxProducts] INT NOT NULL,
    [DurationDays] INT NOT NULL,
    [IsActive] BIT NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_SubscriptionPlans] PRIMARY KEY ([PlanId])
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Master subscription plans managed by admin';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'SubscriptionPlans';
SET @description = N'Duration in days';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'SubscriptionPlans', 'COLUMN', N'DurationDays';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'SubscriptionPlans', 'COLUMN', N'TenantId';
2025-11-05 12:10:23.479 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [UserId] int NOT NULL IDENTITY,
    [Email] NVARCHAR(150) NOT NULL,
    [PasswordHash] NVARCHAR(256) NOT NULL,
    [Phone] NVARCHAR(10) NOT NULL,
    [Role] INT NOT NULL,
    [IsEmailVerified] BIT NOT NULL,
    [IsActive] BIT NOT NULL,
    [LastLogin] datetime2 NULL,
    [FailedLoginAttempts] int NOT NULL,
    [LockoutEnd] datetime2 NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([UserId])
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Last successful login timestamp';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Users', 'COLUMN', N'LastLogin';
SET @description = N'Number of failed login attempts';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Users', 'COLUMN', N'FailedLoginAttempts';
SET @description = N'Account lockout until this time';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Users', 'COLUMN', N'LockoutEnd';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Users', 'COLUMN', N'TenantId';
2025-11-05 12:10:23.866 +05:30 [INF] Executed DbCommand (377ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Customers] (
    [CustomerId] int NOT NULL IDENTITY,
    [FirstName] NVARCHAR(50) NOT NULL,
    [MiddleName] NVARCHAR(50) NULL,
    [LastName] NVARCHAR(50) NOT NULL,
    [DateOfBirth] DATE NULL,
    [Gender] INT NULL,
    [Address] NVARCHAR(500) NULL,
    [City] NVARCHAR(100) NULL,
    [State] NVARCHAR(100) NULL,
    [PinCode] NVARCHAR(10) NULL,
    [IsActive] BIT NOT NULL,
    [UserId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Customers] PRIMARY KEY ([CustomerId]),
    CONSTRAINT [FK_Customers_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([UserId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Customer profile information';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Customers';
SET @description = N'Customer''s first name';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Customers', 'COLUMN', N'FirstName';
SET @description = N'Customer''s middle name';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Customers', 'COLUMN', N'MiddleName';
SET @description = N'Customer''s last name';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Customers', 'COLUMN', N'LastName';
SET @description = N'Customer''s date of birth';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Customers', 'COLUMN', N'DateOfBirth';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Customers', 'COLUMN', N'TenantId';
2025-11-05 12:10:23.881 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [RefreshTokens] (
    [RefreshTokenId] int NOT NULL IDENTITY,
    [Token] NVARCHAR(500) NOT NULL,
    [ExpiresAt] DATETIME2 NOT NULL,
    [IsRevoked] BIT NOT NULL DEFAULT CAST(0 AS BIT),
    [RevokedAt] DATETIME2 NULL,
    [RevokedBy] NVARCHAR(100) NULL,
    [RevokedReason] NVARCHAR(200) NULL,
    [UserId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_RefreshTokens] PRIMARY KEY ([RefreshTokenId]),
    CONSTRAINT [FK_RefreshTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([UserId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Refresh tokens for JWT authentication';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'RefreshTokens';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'RefreshTokens', 'COLUMN', N'TenantId';
2025-11-05 12:10:24.167 +05:30 [INF] Executed DbCommand (279ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Vendors] (
    [VendorId] int NOT NULL IDENTITY,
    [BusinessName] NVARCHAR(150) NOT NULL,
    [OwnerName] NVARCHAR(100) NOT NULL,
    [BusinessLicenseNumber] NVARCHAR(50) NOT NULL,
    [BusinessAddress] NVARCHAR(500) NOT NULL,
    [City] NVARCHAR(100) NULL,
    [State] NVARCHAR(100) NULL,
    [PinCode] NVARCHAR(10) NULL,
    [TaxRegistrationNumber] NVARCHAR(50) NULL,
    [DocumentPath] NVARCHAR(500) NOT NULL,
    [DocumentStatus] INT NOT NULL,
    [RejectionReason] NVARCHAR(500) NULL,
    [VerifiedOn] DATETIME2 NULL,
    [VerifiedBy] NVARCHAR(100) NULL,
    [CurrentPlan] INT NOT NULL,
    [Status] INT NOT NULL,
    [IsActive] BIT NOT NULL,
    [UserId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL DEFAULT (NEWID()),
    CONSTRAINT [PK_Vendors] PRIMARY KEY ([VendorId]),
    CONSTRAINT [FK_Vendors_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([UserId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Vendor information and business details';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors';
SET @description = N'Registration document file path';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors', 'COLUMN', N'DocumentPath';
SET @description = N'Document verification status';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors', 'COLUMN', N'DocumentStatus';
SET @description = N'Reason for document rejection';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors', 'COLUMN', N'RejectionReason';
SET @description = N'Document verification timestamp';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors', 'COLUMN', N'VerifiedOn';
SET @description = N'Admin who verified the document';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors', 'COLUMN', N'VerifiedBy';
SET @description = N'Current subscription plan of the vendor';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors', 'COLUMN', N'CurrentPlan';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Vendors', 'COLUMN', N'TenantId';
2025-11-05 12:10:24.410 +05:30 [INF] Executed DbCommand (220ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Orders] (
    [OrderId] int NOT NULL IDENTITY,
    [OrderNumber] NVARCHAR(20) NOT NULL,
    [TotalAmount] DECIMAL(18,2) NOT NULL,
    [DiscountAmount] DECIMAL(18,2) NULL,
    [ShippingAmount] DECIMAL(18,2) NULL,
    [TaxAmount] DECIMAL(18,2) NULL,
    [Status] INT NOT NULL,
    [ShippingAddress] NVARCHAR(500) NOT NULL,
    [ShippingCity] NVARCHAR(100) NULL,
    [ShippingState] NVARCHAR(100) NULL,
    [ShippingPinCode] NVARCHAR(10) NULL,
    [ShippingPhone] NVARCHAR(15) NULL,
    [ShippedDate] DATETIME2 NULL,
    [DeliveredDate] DATETIME2 NULL,
    [Notes] NVARCHAR(500) NULL,
    [CustomerId] int NOT NULL,
    [VendorId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Orders] PRIMARY KEY ([OrderId]),
    CONSTRAINT [FK_Orders_Customers_CustomerId] FOREIGN KEY ([CustomerId]) REFERENCES [Customers] ([CustomerId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Orders_Vendors_VendorId] FOREIGN KEY ([VendorId]) REFERENCES [Vendors] ([VendorId]) ON DELETE NO ACTION
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Customer orders and order management';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Orders';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Orders', 'COLUMN', N'TenantId';
2025-11-05 12:10:24.535 +05:30 [INF] Executed DbCommand (113ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Products] (
    [ProductId] int NOT NULL IDENTITY,
    [Name] NVARCHAR(200) NOT NULL,
    [Description] NVARCHAR(1000) NULL,
    [SKU] NVARCHAR(50) NOT NULL,
    [Price] DECIMAL(18,2) NOT NULL,
    [DiscountPrice] DECIMAL(18,2) NULL,
    [StockQuantity] INT NOT NULL,
    [MinStockLevel] INT NULL,
    [Brand] nvarchar(100) NULL,
    [Weight] nvarchar(50) NULL,
    [Dimensions] nvarchar(100) NULL,
    [Status] INT NOT NULL,
    [IsActive] BIT NOT NULL,
    [VendorId] int NOT NULL,
    [CategoryId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Products] PRIMARY KEY ([ProductId]),
    CONSTRAINT [FK_Products_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([CategoryId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Products_Vendors_VendorId] FOREIGN KEY ([VendorId]) REFERENCES [Vendors] ([VendorId]) ON DELETE NO ACTION
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Product catalog and inventory management';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Products';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Products', 'COLUMN', N'TenantId';
2025-11-05 12:10:24.736 +05:30 [INF] Executed DbCommand (189ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Subscriptions] (
    [SubscriptionId] int NOT NULL IDENTITY,
    [StartDate] DATE NOT NULL,
    [EndDate] DATE NOT NULL,
    [IsActive] BIT NOT NULL,
    [PlanId] int NOT NULL,
    [VendorId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Subscriptions] PRIMARY KEY ([SubscriptionId]),
    CONSTRAINT [FK_Subscriptions_SubscriptionPlans_PlanId] FOREIGN KEY ([PlanId]) REFERENCES [SubscriptionPlans] ([PlanId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Subscriptions_Vendors_VendorId] FOREIGN KEY ([VendorId]) REFERENCES [Vendors] ([VendorId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Vendor subscription instances';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Subscriptions';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Subscriptions', 'COLUMN', N'TenantId';
2025-11-05 12:10:24.876 +05:30 [INF] Executed DbCommand (121ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [PaymentId] int NOT NULL IDENTITY,
    [Amount] DECIMAL(18,2) NOT NULL,
    [PaymentMethod] INT NOT NULL,
    [Status] INT NOT NULL,
    [PaymentDate] DATETIME2 NOT NULL,
    [TransactionId] NVARCHAR(100) NOT NULL,
    [FailureReason] NVARCHAR(500) NULL,
    [OrderId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([PaymentId]),
    CONSTRAINT [FK_Payments_Orders_OrderId] FOREIGN KEY ([OrderId]) REFERENCES [Orders] ([OrderId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Payment processing and transaction details';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Payments';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Payments', 'COLUMN', N'TenantId';
2025-11-05 12:10:24.890 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Shipping] (
    [ShippingId] int NOT NULL IDENTITY,
    [TrackingNumber] NVARCHAR(100) NULL,
    [CourierService] NVARCHAR(100) NULL,
    [Status] INT NOT NULL,
    [ShippedDate] DATETIME2 NULL,
    [EstimatedDeliveryDate] DATETIME2 NULL,
    [ActualDeliveryDate] DATETIME2 NULL,
    [DeliveryNotes] NVARCHAR(500) NULL,
    [OrderId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Shipping] PRIMARY KEY ([ShippingId]),
    CONSTRAINT [FK_Shipping_Orders_OrderId] FOREIGN KEY ([OrderId]) REFERENCES [Orders] ([OrderId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Order shipping and delivery tracking';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Shipping';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Shipping', 'COLUMN', N'TenantId';
2025-11-05 12:10:24.999 +05:30 [INF] Executed DbCommand (100ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Cart] (
    [CartId] int NOT NULL IDENTITY,
    [Quantity] INT NOT NULL,
    [CustomerId] int NOT NULL,
    [ProductId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Cart] PRIMARY KEY ([CartId]),
    CONSTRAINT [FK_Cart_Customers_CustomerId] FOREIGN KEY ([CustomerId]) REFERENCES [Customers] ([CustomerId]) ON DELETE CASCADE,
    CONSTRAINT [FK_Cart_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Shopping cart items for customers';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Cart';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Cart', 'COLUMN', N'TenantId';
2025-11-05 12:10:25.048 +05:30 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [OrderItems] (
    [OrderItemId] int NOT NULL IDENTITY,
    [Quantity] INT NOT NULL,
    [UnitPrice] DECIMAL(18,2) NOT NULL,
    [DiscountAmount] DECIMAL(18,2) NULL,
    [TotalPrice] DECIMAL(18,2) NOT NULL,
    [OrderId] int NOT NULL,
    [ProductId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_OrderItems] PRIMARY KEY ([OrderItemId]),
    CONSTRAINT [FK_OrderItems_Orders_OrderId] FOREIGN KEY ([OrderId]) REFERENCES [Orders] ([OrderId]) ON DELETE CASCADE,
    CONSTRAINT [FK_OrderItems_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE NO ACTION
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Individual items within an order';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'OrderItems';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'OrderItems', 'COLUMN', N'TenantId';
2025-11-05 12:10:25.095 +05:30 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [ProductImages] (
    [ImageId] int NOT NULL IDENTITY,
    [ImagePath] NVARCHAR(500) NOT NULL,
    [AltText] NVARCHAR(200) NULL,
    [DisplayOrder] INT NOT NULL,
    [IsPrimary] BIT NOT NULL,
    [ProductId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_ProductImages] PRIMARY KEY ([ImageId]),
    CONSTRAINT [FK_ProductImages_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Product images for marketing and display';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'ProductImages';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'ProductImages', 'COLUMN', N'TenantId';
2025-11-05 12:10:25.164 +05:30 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [ReviewId] int NOT NULL IDENTITY,
    [Rating] INT NOT NULL,
    [Comment] NVARCHAR(1000) NULL,
    [IsVerifiedPurchase] BIT NOT NULL,
    [IsActive] BIT NOT NULL,
    [CustomerId] int NOT NULL,
    [ProductId] int NOT NULL,
    [CreatedBy] NVARCHAR(100) NOT NULL,
    [CreatedOn] DATETIME2 NOT NULL,
    [UpdatedBy] NVARCHAR(100) NULL,
    [UpdatedOn] DATETIME2 NULL,
    [IsDeleted] BIT NOT NULL,
    [DeletedOn] DATETIME2 NULL,
    [DeletedBy] NVARCHAR(100) NULL,
    [TenantId] NVARCHAR(100) NOT NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([ReviewId]),
    CONSTRAINT [FK_Reviews_Customers_CustomerId] FOREIGN KEY ([CustomerId]) REFERENCES [Customers] ([CustomerId]) ON DELETE CASCADE,
    CONSTRAINT [FK_Reviews_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE
);
DECLARE @defaultSchema AS sysname;
SET @defaultSchema = SCHEMA_NAME();
DECLARE @description AS sql_variant;
SET @description = N'Customer product reviews with tenant isolation';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Reviews';
SET @description = N'Tenant isolation - each vendor has unique tenant ID';
EXEC sp_addextendedproperty 'MS_Description', @description, 'SCHEMA', @defaultSchema, 'TABLE', N'Reviews', 'COLUMN', N'TenantId';
2025-11-05 12:10:25.770 +05:30 [INF] Executed DbCommand (590ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CategoryId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Description', N'ImagePath', N'IsActive', N'IsDeleted', N'Name', N'ParentCategoryId', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] ON;
INSERT INTO [Categories] ([CategoryId], [CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [Description], [ImagePath], [IsActive], [IsDeleted], [Name], [ParentCategoryId], [TenantId], [UpdatedBy], [UpdatedOn])
VALUES (1, N'System', '2024-01-01T00:00:00.0000000', NULL, NULL, N'Electronic devices and gadgets', NULL, CAST(1 AS BIT), CAST(0 AS BIT), N'Electronics', NULL, N'admin', NULL, NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CategoryId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Description', N'ImagePath', N'IsActive', N'IsDeleted', N'Name', N'ParentCategoryId', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] OFF;
2025-11-05 12:10:25.854 +05:30 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'PlanId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Description', N'DurationDays', N'IsActive', N'IsDeleted', N'MaxProducts', N'PlanName', N'Price', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[SubscriptionPlans]'))
    SET IDENTITY_INSERT [SubscriptionPlans] ON;
INSERT INTO [SubscriptionPlans] ([PlanId], [CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [Description], [DurationDays], [IsActive], [IsDeleted], [MaxProducts], [PlanName], [Price], [TenantId], [UpdatedBy], [UpdatedOn])
VALUES (1, N'System', '2024-01-01T00:00:00.0000000', NULL, NULL, N'Basic plan with 10 products', 30, CAST(1 AS BIT), CAST(0 AS BIT), 10, N'Basic', 999.0, N'admin', NULL, NULL),
(2, N'System', '2024-01-01T00:00:00.0000000', NULL, NULL, N'Standard plan with 50 products', 30, CAST(1 AS BIT), CAST(0 AS BIT), 50, N'Standard', 2999.0, N'admin', NULL, NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'PlanId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Description', N'DurationDays', N'IsActive', N'IsDeleted', N'MaxProducts', N'PlanName', N'Price', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[SubscriptionPlans]'))
    SET IDENTITY_INSERT [SubscriptionPlans] OFF;
2025-11-05 12:10:25.897 +05:30 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'UserId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Email', N'FailedLoginAttempts', N'IsActive', N'IsDeleted', N'IsEmailVerified', N'LastLogin', N'LockoutEnd', N'PasswordHash', N'Phone', N'Role', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] ON;
INSERT INTO [Users] ([UserId], [CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [Email], [FailedLoginAttempts], [IsActive], [IsDeleted], [IsEmailVerified], [LastLogin], [LockoutEnd], [PasswordHash], [Phone], [Role], [TenantId], [UpdatedBy], [UpdatedOn])
VALUES (1, N'System', '2024-01-01T00:00:00.0000000', NULL, NULL, N'admin@ecommerce.com', 0, CAST(1 AS BIT), CAST(0 AS BIT), CAST(1 AS BIT), NULL, NULL, N'hashedpassword123', N'9876543210', 3, N'admin', NULL, NULL),
(2, N'System', '2024-01-01T00:00:00.0000000', NULL, NULL, N'customer1@gmail.com', 0, CAST(1 AS BIT), CAST(0 AS BIT), CAST(1 AS BIT), NULL, NULL, N'hashedpassword123', N'9876543211', 1, N'vendor1', NULL, NULL),
(3, N'System', '2024-01-01T00:00:00.0000000', NULL, NULL, N'vendor1@gmail.com', 0, CAST(1 AS BIT), CAST(0 AS BIT), CAST(1 AS BIT), NULL, NULL, N'hashedpassword123', N'9876543212', 2, N'vendor1', NULL, NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'UserId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Email', N'FailedLoginAttempts', N'IsActive', N'IsDeleted', N'IsEmailVerified', N'LastLogin', N'LockoutEnd', N'PasswordHash', N'Phone', N'Role', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[Users]'))
    SET IDENTITY_INSERT [Users] OFF;
2025-11-05 12:10:25.965 +05:30 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CategoryId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Description', N'ImagePath', N'IsActive', N'IsDeleted', N'Name', N'ParentCategoryId', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] ON;
INSERT INTO [Categories] ([CategoryId], [CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [Description], [ImagePath], [IsActive], [IsDeleted], [Name], [ParentCategoryId], [TenantId], [UpdatedBy], [UpdatedOn])
VALUES (2, N'System', '2024-01-01T00:00:00.0000000', NULL, NULL, N'Mobile phones and accessories', NULL, CAST(1 AS BIT), CAST(0 AS BIT), N'Smartphones', 1, N'admin', NULL, NULL);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CategoryId', N'CreatedBy', N'CreatedOn', N'DeletedBy', N'DeletedOn', N'Description', N'ImagePath', N'IsActive', N'IsDeleted', N'Name', N'ParentCategoryId', N'TenantId', N'UpdatedBy', N'UpdatedOn') AND [object_id] = OBJECT_ID(N'[Categories]'))
    SET IDENTITY_INSERT [Categories] OFF;
2025-11-05 12:10:26.059 +05:30 [INF] Executed DbCommand (85ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CustomerId', N'Address', N'City', N'CreatedBy', N'CreatedOn', N'DateOfBirth', N'DeletedBy', N'DeletedOn', N'FirstName', N'Gender', N'IsActive', N'IsDeleted', N'LastName', N'MiddleName', N'PinCode', N'State', N'TenantId', N'UpdatedBy', N'UpdatedOn', N'UserId') AND [object_id] = OBJECT_ID(N'[Customers]'))
    SET IDENTITY_INSERT [Customers] ON;
INSERT INTO [Customers] ([CustomerId], [Address], [City], [CreatedBy], [CreatedOn], [DateOfBirth], [DeletedBy], [DeletedOn], [FirstName], [Gender], [IsActive], [IsDeleted], [LastName], [MiddleName], [PinCode], [State], [TenantId], [UpdatedBy], [UpdatedOn], [UserId])
VALUES (1, N'456 Oak St, Chennai', N'Chennai', N'System', '2024-01-01T00:00:00.0000000', '1990-05-15T00:00:00.0000000', NULL, NULL, N'Jane', 2, CAST(1 AS BIT), CAST(0 AS BIT), N'Smith', NULL, N'600002', N'Tamil Nadu', N'vendor1', NULL, NULL, 2);
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'CustomerId', N'Address', N'City', N'CreatedBy', N'CreatedOn', N'DateOfBirth', N'DeletedBy', N'DeletedOn', N'FirstName', N'Gender', N'IsActive', N'IsDeleted', N'LastName', N'MiddleName', N'PinCode', N'State', N'TenantId', N'UpdatedBy', N'UpdatedOn', N'UserId') AND [object_id] = OBJECT_ID(N'[Customers]'))
    SET IDENTITY_INSERT [Customers] OFF;
2025-11-05 12:10:26.136 +05:30 [INF] Executed DbCommand (70ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'VendorId', N'BusinessAddress', N'BusinessLicenseNumber', N'BusinessName', N'City', N'CreatedBy', N'CreatedOn', N'CurrentPlan', N'DeletedBy', N'DeletedOn', N'DocumentPath', N'DocumentStatus', N'IsActive', N'IsDeleted', N'OwnerName', N'PinCode', N'RejectionReason', N'State', N'Status', N'TaxRegistrationNumber', N'TenantId', N'UpdatedBy', N'UpdatedOn', N'UserId', N'VerifiedBy', N'VerifiedOn') AND [object_id] = OBJECT_ID(N'[Vendors]'))
    SET IDENTITY_INSERT [Vendors] ON;
INSERT INTO [Vendors] ([VendorId], [BusinessAddress], [BusinessLicenseNumber], [BusinessName], [City], [CreatedBy], [CreatedOn], [CurrentPlan], [DeletedBy], [DeletedOn], [DocumentPath], [DocumentStatus], [IsActive], [IsDeleted], [OwnerName], [PinCode], [RejectionReason], [State], [Status], [TaxRegistrationNumber], [TenantId], [UpdatedBy], [UpdatedOn], [UserId], [VerifiedBy], [VerifiedOn])
VALUES (1, N'123 Main St, Chennai', N'BL123456', N'Tech Store', N'Chennai', N'System', '2024-01-01T00:00:00.0000000', 1, NULL, NULL, N'/docs/license.pdf', 2, CAST(1 AS BIT), CAST(0 AS BIT), N'John Doe', N'600001', NULL, N'Tamil Nadu', 1, NULL, N'vendor1', NULL, NULL, 3, N'Admin', '2024-01-01T00:00:00.0000000');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'VendorId', N'BusinessAddress', N'BusinessLicenseNumber', N'BusinessName', N'City', N'CreatedBy', N'CreatedOn', N'CurrentPlan', N'DeletedBy', N'DeletedOn', N'DocumentPath', N'DocumentStatus', N'IsActive', N'IsDeleted', N'OwnerName', N'PinCode', N'RejectionReason', N'State', N'Status', N'TaxRegistrationNumber', N'TenantId', N'UpdatedBy', N'UpdatedOn', N'UserId', N'VerifiedBy', N'VerifiedOn') AND [object_id] = OBJECT_ID(N'[Vendors]'))
    SET IDENTITY_INSERT [Vendors] OFF;
2025-11-05 12:10:26.236 +05:30 [INF] Executed DbCommand (92ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Cart_CustomerId] ON [Cart] ([CustomerId]);
2025-11-05 12:10:26.244 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Cart_CustomerId_ProductId] ON [Cart] ([CustomerId], [ProductId]);
2025-11-05 12:10:26.290 +05:30 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Cart_ProductId] ON [Cart] ([ProductId]);
2025-11-05 12:10:26.298 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Cart_TenantId] ON [Cart] ([TenantId]);
2025-11-05 12:10:26.574 +05:30 [INF] Executed DbCommand (270ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Categories_Name] ON [Categories] ([Name]);
2025-11-05 12:10:26.617 +05:30 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Categories_ParentCategoryId] ON [Categories] ([ParentCategoryId]);
2025-11-05 12:10:26.634 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Customers_TenantId] ON [Customers] ([TenantId]);
2025-11-05 12:10:26.645 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Customers_UserId] ON [Customers] ([UserId]);
2025-11-05 12:10:26.651 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_OrderItems_OrderId] ON [OrderItems] ([OrderId]);
2025-11-05 12:10:26.661 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_OrderItems_OrderId_ProductId] ON [OrderItems] ([OrderId], [ProductId]);
2025-11-05 12:10:26.693 +05:30 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_OrderItems_ProductId] ON [OrderItems] ([ProductId]);
2025-11-05 12:10:26.698 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Orders_CustomerId] ON [Orders] ([CustomerId]);
2025-11-05 12:10:26.704 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Orders_OrderNumber] ON [Orders] ([OrderNumber]);
2025-11-05 12:10:26.711 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Orders_VendorId] ON [Orders] ([VendorId]);
2025-11-05 12:10:26.717 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Payments_OrderId] ON [Payments] ([OrderId]);
2025-11-05 12:10:26.727 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_PaymentDate] ON [Payments] ([PaymentDate]);
2025-11-05 12:10:26.732 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_Status] ON [Payments] ([Status]);
2025-11-05 12:10:26.739 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Payments_TransactionId] ON [Payments] ([TransactionId]);
2025-11-05 12:10:26.777 +05:30 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_TransactionId1] ON [Payments] ([TransactionId]);
2025-11-05 12:10:26.782 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductImages_DisplayOrder] ON [ProductImages] ([DisplayOrder]);
2025-11-05 12:10:26.792 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductImages_ProductId] ON [ProductImages] ([ProductId]);
2025-11-05 12:10:26.824 +05:30 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ProductImages_ProductId_IsPrimary] ON [ProductImages] ([ProductId], [IsPrimary]);
2025-11-05 12:10:26.831 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Products_CategoryId] ON [Products] ([CategoryId]);
2025-11-05 12:10:26.837 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Products_SKU] ON [Products] ([SKU]);
2025-11-05 12:10:26.845 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Products_Status] ON [Products] ([Status]);
2025-11-05 12:10:26.850 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Products_TenantId] ON [Products] ([TenantId]);
2025-11-05 12:10:26.859 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Products_TenantId_VendorId] ON [Products] ([TenantId], [VendorId]);
2025-11-05 12:10:26.865 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Products_VendorId] ON [Products] ([VendorId]);
2025-11-05 12:10:26.873 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RefreshTokens_ExpiresAt] ON [RefreshTokens] ([ExpiresAt]);
2025-11-05 12:10:26.881 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_RefreshTokens_Token] ON [RefreshTokens] ([Token]);
2025-11-05 12:10:26.889 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RefreshTokens_UserId] ON [RefreshTokens] ([UserId]);
2025-11-05 12:10:26.897 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CustomerId] ON [Reviews] ([CustomerId]);
2025-11-05 12:10:26.906 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Reviews_CustomerId_ProductId] ON [Reviews] ([CustomerId], [ProductId]);
2025-11-05 12:10:26.914 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_ProductId] ON [Reviews] ([ProductId]);
2025-11-05 12:10:26.922 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_Rating] ON [Reviews] ([Rating]);
2025-11-05 12:10:26.929 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_TenantId] ON [Reviews] ([TenantId]);
2025-11-05 12:10:26.935 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Shipping_OrderId] ON [Shipping] ([OrderId]);
2025-11-05 12:10:26.943 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Shipping_ShippedDate] ON [Shipping] ([ShippedDate]);
2025-11-05 12:10:26.965 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Shipping_Status] ON [Shipping] ([Status]);
2025-11-05 12:10:26.993 +05:30 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Shipping_TrackingNumber] ON [Shipping] ([TrackingNumber]) WHERE [TrackingNumber] IS NOT NULL;
2025-11-05 12:10:27.008 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SubscriptionPlans_IsActive] ON [SubscriptionPlans] ([IsActive]);
2025-11-05 12:10:27.017 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_SubscriptionPlans_PlanName] ON [SubscriptionPlans] ([PlanName]);
2025-11-05 12:10:27.027 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Subscriptions_PlanId] ON [Subscriptions] ([PlanId]);
2025-11-05 12:10:27.033 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Subscriptions_VendorId] ON [Subscriptions] ([VendorId]);
2025-11-05 12:10:27.044 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Subscriptions_VendorId_IsActive] ON [Subscriptions] ([VendorId], [IsActive]);
2025-11-05 12:10:27.078 +05:30 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]);
2025-11-05 12:10:27.096 +05:30 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Phone] ON [Users] ([Phone]);
2025-11-05 12:10:27.109 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Vendors_BusinessLicense] ON [Vendors] ([BusinessLicenseNumber]);
2025-11-05 12:10:27.124 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Vendors_BusinessLicenseNumber] ON [Vendors] ([BusinessLicenseNumber]);
2025-11-05 12:10:27.134 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Vendors_Status] ON [Vendors] ([Status]);
2025-11-05 12:10:27.147 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Vendors_TenantId] ON [Vendors] ([TenantId]);
2025-11-05 12:10:27.159 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Vendors_UserId] ON [Vendors] ([UserId]);
2025-11-05 12:10:27.182 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251105063643_InitialCreate', N'9.0.0');
2025-11-05 12:10:27.440 +05:30 [INF] Executed DbCommand (217ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-11-05 13:50:44.105 +05:30 [INF] User profile is available. Using 'C:\Users\SUJITH KUMAR\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-05 13:50:45.199 +05:30 [INF] Now listening on: http://localhost:5108
2025-11-05 13:50:45.205 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-11-05 13:50:45.208 +05:30 [INF] Hosting environment: Development
2025-11-05 13:50:45.213 +05:30 [INF] Content root path: C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Api
2025-11-05 14:03:35.591 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/index.html - null null
2025-11-05 14:03:36.842 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/index.html - 200 null text/html;charset=utf-8 1197.4852ms
2025-11-05 14:03:37.157 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/swagger-ui.css - null null
2025-11-05 14:03:37.237 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/index.css - null null
2025-11-05 14:03:37.240 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/swagger-ui-bundle.js - null null
2025-11-05 14:03:37.240 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/swagger-ui-standalone-preset.js - null null
2025-11-05 14:03:37.458 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/index.js - null null
2025-11-05 14:03:37.459 +05:30 [INF] Sending file. Request path: '/index.css'. Physical path: 'N/A'
2025-11-05 14:03:37.473 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/index.js - 200 null application/javascript;charset=utf-8 12.9314ms
2025-11-05 14:03:37.477 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/index.css - 200 202 text/css 238.8496ms
2025-11-05 14:03:37.524 +05:30 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-11-05 14:03:37.524 +05:30 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-11-05 14:03:37.529 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/swagger-ui.css - 200 152035 text/css 371.4623ms
2025-11-05 14:03:37.530 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/swagger-ui-standalone-preset.js - 200 230007 text/javascript 289.7535ms
2025-11-05 14:03:37.754 +05:30 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-11-05 14:03:37.758 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/swagger-ui-bundle.js - 200 1426050 text/javascript 518.2923ms
2025-11-05 14:03:38.414 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/v1/swagger.json - null null
2025-11-05 14:03:39.453 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 1038.5418ms
2025-11-05 14:25:42.761 +05:30 [INF] Application is shutting down...
2025-11-05 22:01:00.893 +05:30 [INF] User profile is available. Using 'C:\Users\SUJITH KUMAR\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-05 22:01:01.688 +05:30 [INF] Now listening on: http://localhost:5108
2025-11-05 22:01:01.697 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-11-05 22:01:01.718 +05:30 [INF] Hosting environment: Development
2025-11-05 22:01:01.720 +05:30 [INF] Content root path: C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Api
2025-11-05 22:01:10.998 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/index.html - null null
2025-11-05 22:01:11.735 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/index.html - 200 null text/html;charset=utf-8 683.7204ms
2025-11-05 22:01:12.069 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/index.js - null null
2025-11-05 22:01:12.343 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/index.js - 200 null application/javascript;charset=utf-8 273.5635ms
2025-11-05 22:01:13.287 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/v1/swagger.json - null null
2025-11-05 22:01:13.683 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 396.6471ms
2025-11-05 22:03:22.750 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - application/json 328
2025-11-05 22:03:22.874 +05:30 [WRN] Failed to determine the https port for redirect.
2025-11-05 22:03:22.897 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:03:23.374 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:03:23.521 +05:30 [INF] Route matched with {action = "RegisterWithOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterWithOtp(Kanini.Ecommerce.Application.DTOs.RegisterWithOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:03:24.479 +05:30 [INF] OTP generation started for Email: sujithkumarsenthilkumar777@gmail.com, Type: Registration
2025-11-05 22:03:24.486 +05:30 [INF] OTP generation started for Email: sujithkumarsenthilkumar777@gmail.com, Type: Registration
2025-11-05 22:03:24.579 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:03:26.489 +05:30 [WRN] No user found for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:03:26.507 +05:30 [INF] OTP generated successfully
2025-11-05 22:03:26.661 +05:30 [INF] OTP JWT token with registration data created for email: sujithkumarsenthilkumar777@gmail.com, type: Registration_1
2025-11-05 22:03:26.671 +05:30 [INF] Email sending started to: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:03:31.205 +05:30 [INF] Email sent successfully to: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:03:31.209 +05:30 [INF] OTP sent successfully to Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:03:31.212 +05:30 [INF] OTP sent successfully to Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:03:31.225 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.OtpResponseDto'.
2025-11-05 22:03:31.277 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api) in 7740.0935ms
2025-11-05 22:03:31.282 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:03:31.292 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - 200 null application/json; charset=utf-8 8542.2564ms
2025-11-05 22:13:56.916 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1163
2025-11-05 22:13:56.972 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:13:56.980 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:13:57.032 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:13:57.068 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:13:57.098 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:13:57.502 +05:30 [WRN] OTP validation failed for email: sujithkumarsenthilkumar777@gmail.com
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05-11-2025 16:38:26', Current time (UTC): '05-11-2025 16:43:57'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Kanini.Ecommerce.Application.Services.Auth.JwtOtpService.ValidateOtp(String jwtToken, String inputOtp, String email, String otpType) in C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Application\Services\Auth\JwtOtpService.cs:line 153
2025-11-05 22:13:57.553 +05:30 [WRN] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:13:57.555 +05:30 [ERR] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:13:57.580 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 22:13:57.604 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 567.166ms
2025-11-05 22:13:57.607 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:13:57.611 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 400 null application/json; charset=utf-8 695.0945ms
2025-11-05 22:15:21.992 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - application/json 307
2025-11-05 22:15:22.003 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:15:22.016 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:15:22.034 +05:30 [INF] Route matched with {action = "RegisterWithOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterWithOtp(Kanini.Ecommerce.Application.DTOs.RegisterWithOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:15:22.070 +05:30 [INF] OTP generation started for Email: sujithkumarsenthilkumar777@gmail.com, Type: Registration
2025-11-05 22:15:22.085 +05:30 [INF] OTP generation started for Email: sujithkumarsenthilkumar777@gmail.com, Type: Registration
2025-11-05 22:15:22.091 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:15:22.471 +05:30 [WRN] No user found for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:15:22.474 +05:30 [INF] OTP generated successfully
2025-11-05 22:15:22.482 +05:30 [INF] OTP JWT token with registration data created for email: sujithkumarsenthilkumar777@gmail.com, type: Registration_1
2025-11-05 22:15:22.487 +05:30 [INF] Email sending started to: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:15:25.843 +05:30 [INF] Email sent successfully to: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:15:25.848 +05:30 [INF] OTP sent successfully to Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:15:25.859 +05:30 [INF] OTP sent successfully to Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:15:25.865 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.OtpResponseDto'.
2025-11-05 22:15:25.879 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api) in 3838.6088ms
2025-11-05 22:15:25.886 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:15:25.895 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - 200 null application/json; charset=utf-8 3903.0901ms
2025-11-05 22:16:33.121 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1162
2025-11-05 22:16:33.128 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:16:33.138 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:16:33.141 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:16:33.167 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:16:33.169 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:16:33.189 +05:30 [INF] OTP validation result for email: sujithkumarsenthilkumar777@gmail.com - true
2025-11-05 22:16:33.242 +05:30 [INF] Executing stored procedure sp_CheckEmailExists for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:16:33.716 +05:30 [ERR] Database error in IsEmailExistsAsync for Email: sujithkumarsenthilkumar777@gmail.com
Microsoft.Data.SqlClient.SqlException (0x80131904): Could not find stored procedure 'sp_CheckEmailExists'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)
   at Microsoft.Data.SqlClient.SqlCommand.InternalEndExecuteReader(IAsyncResult asyncResult, Boolean isInternal, String endMethod)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteReaderInternal(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteReaderAsync(IAsyncResult asyncResult)
   at Microsoft.Data.SqlClient.SqlCommand.EndExecuteReaderAsyncCallback(IAsyncResult asyncResult)
   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)
--- End of stack trace from previous location ---
   at Kanini.Ecommerce.Data.Repositories.Auth.AuthRepository.IsEmailExistsAsync(String email) in C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Data\Repositories\Auth\AuthRepository.cs:line 627
ClientConnectionId:360a79e7-60a2-4986-8b60-571a28dfaa43
Error Number:2812,State:62,Class:16
2025-11-05 22:16:33.883 +05:30 [ERR] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:16:33.886 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 22:16:33.890 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 737.0237ms
2025-11-05 22:16:33.895 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:16:33.902 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 400 null application/json; charset=utf-8 780.5524ms
2025-11-05 22:20:56.544 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1162
2025-11-05 22:20:56.552 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:20:56.554 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:20:56.557 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:20:56.593 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:20:56.599 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:20:56.602 +05:30 [WRN] OTP validation failed for email: sujithkumarsenthilkumar777@gmail.com
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05-11-2025 16:50:22', Current time (UTC): '05-11-2025 16:50:56'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Kanini.Ecommerce.Application.Services.Auth.JwtOtpService.ValidateOtp(String jwtToken, String inputOtp, String email, String otpType) in C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Application\Services\Auth\JwtOtpService.cs:line 153
2025-11-05 22:20:56.639 +05:30 [WRN] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:20:56.649 +05:30 [ERR] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:20:56.653 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 22:20:56.660 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 67.3494ms
2025-11-05 22:20:56.666 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:20:56.673 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 400 null application/json; charset=utf-8 126.5991ms
2025-11-05 22:21:09.870 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1162
2025-11-05 22:21:09.907 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:21:09.921 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:21:09.932 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:21:09.939 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:09.948 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:09.951 +05:30 [WRN] OTP validation failed for email: sujithkumarsenthilkumar777@gmail.com
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05-11-2025 16:50:22', Current time (UTC): '05-11-2025 16:51:09'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Kanini.Ecommerce.Application.Services.Auth.JwtOtpService.ValidateOtp(String jwtToken, String inputOtp, String email, String otpType) in C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Application\Services\Auth\JwtOtpService.cs:line 153
2025-11-05 22:21:09.972 +05:30 [WRN] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:09.980 +05:30 [ERR] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:09.983 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 22:21:09.988 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 50.1335ms
2025-11-05 22:21:10.001 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:21:10.004 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 400 null application/json; charset=utf-8 133.1727ms
2025-11-05 22:21:46.333 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - application/json 307
2025-11-05 22:21:46.342 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:21:46.347 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:21:46.364 +05:30 [INF] Route matched with {action = "RegisterWithOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterWithOtp(Kanini.Ecommerce.Application.DTOs.RegisterWithOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:21:46.380 +05:30 [INF] OTP generation started for Email: sujithkumarsenthilkumar777@gmail.com, Type: Registration
2025-11-05 22:21:46.382 +05:30 [INF] OTP generation started for Email: sujithkumarsenthilkumar777@gmail.com, Type: Registration
2025-11-05 22:21:46.392 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:46.534 +05:30 [WRN] No user found for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:46.538 +05:30 [INF] OTP generated successfully
2025-11-05 22:21:46.540 +05:30 [INF] OTP JWT token with registration data created for email: sujithkumarsenthilkumar777@gmail.com, type: Registration_1
2025-11-05 22:21:46.543 +05:30 [INF] Email sending started to: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:50.412 +05:30 [INF] Email sent successfully to: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:50.419 +05:30 [INF] OTP sent successfully to Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:50.428 +05:30 [INF] OTP sent successfully to Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:21:50.439 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.OtpResponseDto'.
2025-11-05 22:21:50.450 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api) in 4071.6626ms
2025-11-05 22:21:50.458 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:21:50.466 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - 200 null application/json; charset=utf-8 4133.179ms
2025-11-05 22:24:00.206 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1162
2025-11-05 22:24:00.215 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:24:00.225 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:24:00.243 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:24:00.254 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:00.262 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:00.268 +05:30 [WRN] OTP validation failed for email: sujithkumarsenthilkumar777@gmail.com
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05-11-2025 16:50:22', Current time (UTC): '05-11-2025 16:54:00'.
   at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateJWS(String token, TokenValidationParameters validationParameters, BaseConfiguration currentConfiguration, SecurityToken& signatureValidatedToken, ExceptionDispatchInfo& exceptionThrown)
--- End of stack trace from previous location ---
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, JwtSecurityToken outerToken, TokenValidationParameters validationParameters, SecurityToken& signatureValidatedToken)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Kanini.Ecommerce.Application.Services.Auth.JwtOtpService.ValidateOtp(String jwtToken, String inputOtp, String email, String otpType) in C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Application\Services\Auth\JwtOtpService.cs:line 153
2025-11-05 22:24:00.293 +05:30 [WRN] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:00.295 +05:30 [ERR] OTP validation failed for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:00.297 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 22:24:00.309 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 56.7145ms
2025-11-05 22:24:00.312 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:24:00.318 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 400 null application/json; charset=utf-8 111.2485ms
2025-11-05 22:24:27.876 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1162
2025-11-05 22:24:27.891 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:24:27.919 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:24:27.923 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:24:27.938 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:27.941 +05:30 [INF] OTP validation started for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:27.949 +05:30 [INF] OTP validation result for email: sujithkumarsenthilkumar777@gmail.com - true
2025-11-05 22:24:27.952 +05:30 [INF] Executing stored procedure sp_CheckEmailExists for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:28.070 +05:30 [INF] Email exists check result for sujithkumarsenthilkumar777@gmail.com: false
2025-11-05 22:24:28.074 +05:30 [INF] OTP validation successful for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:28.084 +05:30 [INF] Registration data extracted from token successfully
2025-11-05 22:24:28.119 +05:30 [INF] Creating user for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:30.301 +05:30 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'RefreshToken'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-11-05 22:24:31.373 +05:30 [INF] Executed DbCommand (236ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (DbType = DateTime2), @p2='?' (Size = 100), @p3='?' (DbType = DateTime2), @p4='?' (Size = 150), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (DbType = Boolean), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2), @p11='?' (Size = 256), @p12='?' (Size = 10), @p13='?' (DbType = Int32), @p14='?' (Size = 100), @p15='?' (Size = 100), @p16='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [Email], [FailedLoginAttempts], [IsActive], [IsDeleted], [IsEmailVerified], [LastLogin], [LockoutEnd], [PasswordHash], [Phone], [Role], [TenantId], [UpdatedBy], [UpdatedOn])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-11-05 22:24:31.453 +05:30 [INF] User created successfully with UserId: 1001
2025-11-05 22:24:31.459 +05:30 [INF] Creating customer for UserId: 1001
2025-11-05 22:24:31.794 +05:30 [INF] Executed DbCommand (166ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Date), @p5='?' (Size = 100), @p6='?' (DbType = DateTime2), @p7='?' (Size = 50), @p8='?' (DbType = Int32), @p9='?' (DbType = Boolean), @p10='?' (DbType = Boolean), @p11='?' (Size = 50), @p12='?' (Size = 50), @p13='?' (Size = 10), @p14='?' (Size = 100), @p15='?' (Size = 100), @p16='?' (Size = 100), @p17='?' (DbType = DateTime2), @p18='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Customers] ([Address], [City], [CreatedBy], [CreatedOn], [DateOfBirth], [DeletedBy], [DeletedOn], [FirstName], [Gender], [IsActive], [IsDeleted], [LastName], [MiddleName], [PinCode], [State], [TenantId], [UpdatedBy], [UpdatedOn], [UserId])
OUTPUT INSERTED.[CustomerId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);
2025-11-05 22:24:31.953 +05:30 [INF] Customer created successfully with CustomerId: 1001
2025-11-05 22:24:31.956 +05:30 [INF] OTP validation successful for Email: sujithkumarsenthilkumar777@gmail.com
2025-11-05 22:24:31.960 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.RegistrationResponseDto'.
2025-11-05 22:24:31.967 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 4030.4314ms
2025-11-05 22:24:31.976 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:24:32.001 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 200 null application/json; charset=utf-8 4125.467ms
2025-11-05 22:28:01.714 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/refresh - application/json 1083
2025-11-05 22:28:01.720 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:28:01.728 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RefreshToken (Kanini.Ecommerce.Api)'
2025-11-05 22:28:01.749 +05:30 [INF] Route matched with {action = "RefreshToken", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RefreshToken(Kanini.Ecommerce.Application.DTOs.RefreshTokenRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:28:01.775 +05:30 [INF] Token refresh attempt started
2025-11-05 22:28:01.779 +05:30 [INF] Token refresh attempt started
2025-11-05 22:28:01.785 +05:30 [INF] Executing stored procedure sp_GetUserByRefreshToken
2025-11-05 22:28:01.865 +05:30 [WRN] No user found for refresh token
2025-11-05 22:28:01.868 +05:30 [WRN] Token refresh failed: Invalid refresh token
2025-11-05 22:28:01.870 +05:30 [ERR] Token refresh failed: Invalid or expired refresh token
2025-11-05 22:28:01.875 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 22:28:01.879 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.RefreshToken (Kanini.Ecommerce.Api) in 118.1885ms
2025-11-05 22:28:01.882 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RefreshToken (Kanini.Ecommerce.Api)'
2025-11-05 22:28:01.884 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/refresh - 400 null application/json; charset=utf-8 170.5332ms
2025-11-05 22:30:59.097 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - application/json 426
2025-11-05 22:30:59.110 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:30:59.112 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:30:59.117 +05:30 [INF] Route matched with {action = "RegisterWithOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterWithOtp(Kanini.Ecommerce.Application.DTOs.RegisterWithOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:30:59.137 +05:30 [INF] OTP generation started for Email: sujinano777@gmail.com, Type: Registration
2025-11-05 22:30:59.143 +05:30 [INF] OTP generation started for Email: sujinano777@gmail.com, Type: Registration
2025-11-05 22:30:59.147 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujinano777@gmail.com
2025-11-05 22:30:59.184 +05:30 [WRN] No user found for Email: sujinano777@gmail.com
2025-11-05 22:30:59.187 +05:30 [INF] OTP generated successfully
2025-11-05 22:30:59.193 +05:30 [INF] OTP JWT token with registration data created for email: sujinano777@gmail.com, type: Registration_2
2025-11-05 22:30:59.197 +05:30 [INF] Email sending started to: sujinano777@gmail.com
2025-11-05 22:31:02.663 +05:30 [INF] Email sent successfully to: sujinano777@gmail.com
2025-11-05 22:31:02.669 +05:30 [INF] OTP sent successfully to Email: sujinano777@gmail.com
2025-11-05 22:31:02.673 +05:30 [INF] OTP sent successfully to Email: sujinano777@gmail.com
2025-11-05 22:31:02.676 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.OtpResponseDto'.
2025-11-05 22:31:02.680 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api) in 3544.8972ms
2025-11-05 22:31:02.683 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:31:02.691 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - 200 null application/json; charset=utf-8 3594.5329ms
2025-11-05 22:32:54.662 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1177
2025-11-05 22:32:54.671 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:32:54.677 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:32:54.687 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:32:54.699 +05:30 [INF] OTP validation started for Email: sujinano777@gmail.com
2025-11-05 22:32:54.701 +05:30 [INF] OTP validation started for Email: sujinano777@gmail.com
2025-11-05 22:32:54.704 +05:30 [INF] OTP validation result for email: sujinano777@gmail.com - true
2025-11-05 22:32:54.712 +05:30 [INF] Executing stored procedure sp_CheckEmailExists for Email: sujinano777@gmail.com
2025-11-05 22:32:54.870 +05:30 [INF] Email exists check result for sujinano777@gmail.com: false
2025-11-05 22:32:54.874 +05:30 [INF] OTP validation successful for Email: sujinano777@gmail.com
2025-11-05 22:32:54.876 +05:30 [INF] Registration data extracted from token successfully
2025-11-05 22:32:54.879 +05:30 [INF] Creating user for Email: sujinano777@gmail.com
2025-11-05 22:32:56.084 +05:30 [INF] Executed DbCommand (1,100ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (DbType = DateTime2), @p2='?' (Size = 100), @p3='?' (DbType = DateTime2), @p4='?' (Size = 150), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (DbType = Boolean), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2), @p11='?' (Size = 256), @p12='?' (Size = 10), @p13='?' (DbType = Int32), @p14='?' (Size = 100), @p15='?' (Size = 100), @p16='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [Email], [FailedLoginAttempts], [IsActive], [IsDeleted], [IsEmailVerified], [LastLogin], [LockoutEnd], [PasswordHash], [Phone], [Role], [TenantId], [UpdatedBy], [UpdatedOn])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-11-05 22:32:56.405 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'Kanini.Ecommerce.Data.DatabaseContext.EcommerceDatabaseContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Users' with unique index 'IX_Users_Phone'. The duplicate key value is (9876543211).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:360a79e7-60a2-4986-8b60-571a28dfaa43
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Users' with unique index 'IX_Users_Phone'. The duplicate key value is (9876543211).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:360a79e7-60a2-4986-8b60-571a28dfaa43
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-11-05 22:32:56.447 +05:30 [ERR] Database error in CreateUserAsync for Email: sujinano777@gmail.com
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'dbo.Users' with unique index 'IX_Users_Phone'. The duplicate key value is (9876543211).
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:360a79e7-60a2-4986-8b60-571a28dfaa43
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Kanini.Ecommerce.Data.Repositories.Auth.AuthRepository.CreateUserAsync(User user) in C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Data\Repositories\Auth\AuthRepository.cs:line 748
2025-11-05 22:32:56.478 +05:30 [ERR] OTP validation failed for Email: sujinano777@gmail.com
2025-11-05 22:32:56.480 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 22:32:56.483 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 1784.7277ms
2025-11-05 22:32:56.488 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:32:56.492 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 400 null application/json; charset=utf-8 1829.98ms
2025-11-05 22:35:54.966 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - application/json 426
2025-11-05 22:35:54.976 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:35:54.978 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:35:54.980 +05:30 [INF] Route matched with {action = "RegisterWithOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RegisterWithOtp(Kanini.Ecommerce.Application.DTOs.RegisterWithOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:35:54.993 +05:30 [INF] OTP generation started for Email: sujinano777@gmail.com, Type: Registration
2025-11-05 22:35:54.995 +05:30 [INF] OTP generation started for Email: sujinano777@gmail.com, Type: Registration
2025-11-05 22:35:54.998 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujinano777@gmail.com
2025-11-05 22:35:55.033 +05:30 [WRN] No user found for Email: sujinano777@gmail.com
2025-11-05 22:35:55.035 +05:30 [INF] OTP generated successfully
2025-11-05 22:35:55.039 +05:30 [INF] OTP JWT token with registration data created for email: sujinano777@gmail.com, type: Registration_2
2025-11-05 22:35:55.041 +05:30 [INF] Email sending started to: sujinano777@gmail.com
2025-11-05 22:35:58.184 +05:30 [INF] Email sent successfully to: sujinano777@gmail.com
2025-11-05 22:35:58.186 +05:30 [INF] OTP sent successfully to Email: sujinano777@gmail.com
2025-11-05 22:35:58.188 +05:30 [INF] OTP sent successfully to Email: sujinano777@gmail.com
2025-11-05 22:35:58.190 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.OtpResponseDto'.
2025-11-05 22:35:58.192 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api) in 3199.7786ms
2025-11-05 22:35:58.195 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.RegisterWithOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:35:58.201 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/register-with-otp - 200 null application/json; charset=utf-8 3235.5681ms
2025-11-05 22:37:02.002 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - application/json 1177
2025-11-05 22:37:02.008 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:37:02.068 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:37:02.070 +05:30 [INF] Route matched with {action = "VerifyRegistrationOtp", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] VerifyRegistrationOtp(Kanini.Ecommerce.Application.DTOs.VerifyRegistrationOtpRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 22:37:02.075 +05:30 [INF] OTP validation started for Email: sujinano777@gmail.com
2025-11-05 22:37:02.077 +05:30 [INF] OTP validation started for Email: sujinano777@gmail.com
2025-11-05 22:37:02.083 +05:30 [INF] OTP validation result for email: sujinano777@gmail.com - true
2025-11-05 22:37:02.085 +05:30 [INF] Executing stored procedure sp_CheckEmailExists for Email: sujinano777@gmail.com
2025-11-05 22:37:02.100 +05:30 [INF] Email exists check result for sujinano777@gmail.com: false
2025-11-05 22:37:02.102 +05:30 [INF] OTP validation successful for Email: sujinano777@gmail.com
2025-11-05 22:37:02.105 +05:30 [INF] Registration data extracted from token successfully
2025-11-05 22:37:02.108 +05:30 [INF] Creating user for Email: sujinano777@gmail.com
2025-11-05 22:37:02.372 +05:30 [INF] Executed DbCommand (226ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (DbType = DateTime2), @p2='?' (Size = 100), @p3='?' (DbType = DateTime2), @p4='?' (Size = 150), @p5='?' (DbType = Int32), @p6='?' (DbType = Boolean), @p7='?' (DbType = Boolean), @p8='?' (DbType = Boolean), @p9='?' (DbType = DateTime2), @p10='?' (DbType = DateTime2), @p11='?' (Size = 256), @p12='?' (Size = 10), @p13='?' (DbType = Int32), @p14='?' (Size = 100), @p15='?' (Size = 100), @p16='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [Email], [FailedLoginAttempts], [IsActive], [IsDeleted], [IsEmailVerified], [LastLogin], [LockoutEnd], [PasswordHash], [Phone], [Role], [TenantId], [UpdatedBy], [UpdatedOn])
OUTPUT INSERTED.[UserId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-11-05 22:37:02.380 +05:30 [INF] User created successfully with UserId: 1003
2025-11-05 22:37:02.386 +05:30 [INF] Creating vendor for UserId: 1003
2025-11-05 22:37:02.835 +05:30 [INF] Executed DbCommand (288ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (Size = 50), @p2='?' (Size = 150), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (DbType = DateTime2), @p6='?' (DbType = Int32), @p7='?' (Size = 100), @p8='?' (DbType = DateTime2), @p9='?' (Size = 500), @p10='?' (DbType = Int32), @p11='?' (DbType = Boolean), @p12='?' (DbType = Boolean), @p13='?' (Size = 100), @p14='?' (Size = 10), @p15='?' (Size = 500), @p16='?' (Size = 100), @p17='?' (DbType = Int32), @p18='?' (Size = 50), @p19='?' (Size = 100), @p20='?' (Size = 100), @p21='?' (DbType = DateTime2), @p22='?' (DbType = Int32), @p23='?' (Size = 100), @p24='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Vendors] ([BusinessAddress], [BusinessLicenseNumber], [BusinessName], [City], [CreatedBy], [CreatedOn], [CurrentPlan], [DeletedBy], [DeletedOn], [DocumentPath], [DocumentStatus], [IsActive], [IsDeleted], [OwnerName], [PinCode], [RejectionReason], [State], [Status], [TaxRegistrationNumber], [TenantId], [UpdatedBy], [UpdatedOn], [UserId], [VerifiedBy], [VerifiedOn])
OUTPUT INSERTED.[VendorId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24);
2025-11-05 22:37:02.852 +05:30 [INF] Vendor created successfully with VendorId: 1001
2025-11-05 22:37:02.855 +05:30 [INF] OTP validation successful for Email: sujinano777@gmail.com
2025-11-05 22:37:02.857 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.RegistrationResponseDto'.
2025-11-05 22:37:02.859 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api) in 785.0133ms
2025-11-05 22:37:02.865 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.VerifyRegistrationOtp (Kanini.Ecommerce.Api)'
2025-11-05 22:37:02.870 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/verify-registration-otp - 200 null application/json; charset=utf-8 867.3551ms
2025-11-05 22:40:55.131 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Vendor/1001/upload-document - multipart/form-data; boundary=----WebKitFormBoundaryoXXRZoCt2M0ZCx2q 350108
2025-11-05 22:40:55.175 +05:30 [INF] CORS policy execution successful.
2025-11-05 22:40:55.189 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.VendorController.UploadDocument (Kanini.Ecommerce.Api)'
2025-11-05 22:41:00.273 +05:30 [INF] Route matched with {action = "UploadDocument", controller = "Vendor"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UploadDocument(Int32, Microsoft.AspNetCore.Http.IFormFile) on controller Kanini.Ecommerce.Api.Controllers.VendorController (Kanini.Ecommerce.Api).
2025-11-05 22:41:00.799 +05:30 [INF] Document upload started for VendorId: 1001
2025-11-05 22:41:00.866 +05:30 [INF] Document upload started for VendorId: 1001
2025-11-05 22:41:00.883 +05:30 [INF] Executing stored procedure sp_GetVendorById for VendorId: 1001
2025-11-05 22:41:01.609 +05:30 [INF] Vendor found for VendorId: 1001, BusinessName: Tech Solutions Pvt Ltd
2025-11-05 22:41:07.007 +05:30 [INF] Executed DbCommand (61ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [v].[VendorId], [v].[BusinessAddress], [v].[BusinessLicenseNumber], [v].[BusinessName], [v].[City], [v].[CreatedBy], [v].[CreatedOn], [v].[CurrentPlan], [v].[DeletedBy], [v].[DeletedOn], [v].[DocumentPath], [v].[DocumentStatus], [v].[IsActive], [v].[IsDeleted], [v].[OwnerName], [v].[PinCode], [v].[RejectionReason], [v].[State], [v].[Status], [v].[TaxRegistrationNumber], [v].[TenantId], [v].[UpdatedBy], [v].[UpdatedOn], [v].[UserId], [v].[VerifiedBy], [v].[VerifiedOn]
FROM [Vendors] AS [v]
WHERE [v].[IsDeleted] = CAST(0 AS BIT) AND [v].[VendorId] = @__p_0
2025-11-05 22:41:07.975 +05:30 [INF] Executed DbCommand (922ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (Size = 500), @p1='?' (Size = 100), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Vendors] SET [DocumentPath] = @p0, [UpdatedBy] = @p1, [UpdatedOn] = @p2
OUTPUT 1
WHERE [VendorId] = @p3;
2025-11-05 22:41:08.017 +05:30 [INF] Document uploaded for VendorId: 1001
2025-11-05 22:41:08.030 +05:30 [INF] Document uploaded for VendorId: 1001
2025-11-05 22:41:08.036 +05:30 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-11-05 22:41:08.051 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.VendorController.UploadDocument (Kanini.Ecommerce.Api) in 7773.0261ms
2025-11-05 22:41:08.098 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.VendorController.UploadDocument (Kanini.Ecommerce.Api)'
2025-11-05 22:41:08.195 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Vendor/1001/upload-document - 200 null application/json; charset=utf-8 13064.8577ms
2025-11-05 22:41:33.709 +05:30 [INF] Application is shutting down...
2025-11-05 23:10:48.278 +05:30 [INF] User profile is available. Using 'C:\Users\SUJITH KUMAR\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-11-05 23:10:48.577 +05:30 [INF] Now listening on: http://localhost:5108
2025-11-05 23:10:48.581 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-11-05 23:10:48.584 +05:30 [INF] Hosting environment: Development
2025-11-05 23:10:48.586 +05:30 [INF] Content root path: C:\Users\SUJITH KUMAR\OneDrive\Documents\Kanini\Ecommerce_React_Api\Backend\Kanini.Ecommerce.Api
2025-11-05 23:11:11.566 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/index.html - null null
2025-11-05 23:11:12.193 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/index.html - 200 null text/html;charset=utf-8 604.0193ms
2025-11-05 23:11:13.251 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/index.js - null null
2025-11-05 23:11:13.301 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/index.js - 200 null application/javascript;charset=utf-8 50.0388ms
2025-11-05 23:11:20.091 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/v1/swagger.json - null null
2025-11-05 23:11:20.161 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/swagger/favicon-32x32.png - null null
2025-11-05 23:11:20.560 +05:30 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-11-05 23:11:20.565 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/favicon-32x32.png - 200 628 image/png 403.9743ms
2025-11-05 23:11:21.042 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 950.552ms
2025-11-05 23:11:34.686 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5108/api/Admin/vendors/pending - null null
2025-11-05 23:11:34.753 +05:30 [WRN] Failed to determine the https port for redirect.
2025-11-05 23:11:37.104 +05:30 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-11-05 23:11:37.113 +05:30 [INF] AuthenticationScheme: Bearer was challenged.
2025-11-05 23:11:37.116 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5108/api/Admin/vendors/pending - 401 0 null 2430.6921ms
2025-11-05 23:23:53.351 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/login - application/json 74
2025-11-05 23:23:53.416 +05:30 [INF] CORS policy execution successful.
2025-11-05 23:23:53.429 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:23:53.595 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Kanini.Ecommerce.Application.DTOs.LoginRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 23:23:54.541 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:23:54.549 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:23:54.634 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:23:56.113 +05:30 [INF] User found for Email: sujithkumar.kanini@outlook.com, UserId: 1010
2025-11-05 23:23:56.142 +05:30 [INF] Executing stored procedure sp_ValidateUserCredentials for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:23:56.288 +05:30 [INF] Credential validation result for Email: sujithkumar.kanini@outlook.com - false
2025-11-05 23:23:58.133 +05:30 [WRN] Entity 'User' has a global query filter defined and is the required end of a relationship with the entity 'RefreshToken'. This may lead to unexpected results when the required entity is filtered out. Either configure the navigation as optional, or define matching query filters for both entities in the navigation. See https://go.microsoft.com/fwlink/?linkid=2131316 for more information.
2025-11-05 23:23:59.550 +05:30 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedBy], [u].[CreatedOn], [u].[DeletedBy], [u].[DeletedOn], [u].[Email], [u].[FailedLoginAttempts], [u].[IsActive], [u].[IsDeleted], [u].[IsEmailVerified], [u].[LastLogin], [u].[LockoutEnd], [u].[PasswordHash], [u].[Phone], [u].[Role], [u].[TenantId], [u].[UpdatedBy], [u].[UpdatedOn]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS BIT) AND [u].[UserId] = @__p_0
2025-11-05 23:23:59.933 +05:30 [INF] Executed DbCommand (127ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 100), @p2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FailedLoginAttempts] = @p0, [UpdatedBy] = @p1, [UpdatedOn] = @p2
OUTPUT 1
WHERE [UserId] = @p3;
2025-11-05 23:23:59.965 +05:30 [WRN] Login failed: Invalid credentials
2025-11-05 23:23:59.969 +05:30 [ERR] Login failed: Invalid email or password
2025-11-05 23:23:59.982 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 23:24:00.047 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api) in 6436.4803ms
2025-11-05 23:24:00.051 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:24:00.072 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/login - 400 null application/json; charset=utf-8 6720.4223ms
2025-11-05 23:24:51.524 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/login - application/json 73
2025-11-05 23:24:51.552 +05:30 [INF] CORS policy execution successful.
2025-11-05 23:24:51.555 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:24:51.563 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Kanini.Ecommerce.Application.DTOs.LoginRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 23:24:51.574 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:24:51.580 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:24:51.584 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:24:51.591 +05:30 [INF] User found for Email: sujithkumar.kanini@outlook.com, UserId: 1010
2025-11-05 23:24:51.598 +05:30 [INF] Executing stored procedure sp_ValidateUserCredentials for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:24:51.606 +05:30 [INF] Credential validation result for Email: sujithkumar.kanini@outlook.com - false
2025-11-05 23:24:51.890 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedBy], [u].[CreatedOn], [u].[DeletedBy], [u].[DeletedOn], [u].[Email], [u].[FailedLoginAttempts], [u].[IsActive], [u].[IsDeleted], [u].[IsEmailVerified], [u].[LastLogin], [u].[LockoutEnd], [u].[PasswordHash], [u].[Phone], [u].[Role], [u].[TenantId], [u].[UpdatedBy], [u].[UpdatedOn]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS BIT) AND [u].[UserId] = @__p_0
2025-11-05 23:24:51.923 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FailedLoginAttempts] = @p0, [UpdatedOn] = @p1
OUTPUT 1
WHERE [UserId] = @p2;
2025-11-05 23:24:51.934 +05:30 [WRN] Login failed: Invalid credentials
2025-11-05 23:24:51.937 +05:30 [ERR] Login failed: Invalid email or password
2025-11-05 23:24:51.939 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 23:24:51.944 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api) in 374.7624ms
2025-11-05 23:24:51.952 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:24:51.955 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/login - 400 null application/json; charset=utf-8 431.0949ms
2025-11-05 23:29:13.481 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/login - application/json 73
2025-11-05 23:29:13.541 +05:30 [INF] CORS policy execution successful.
2025-11-05 23:29:13.546 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:29:13.549 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Kanini.Ecommerce.Application.DTOs.LoginRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 23:29:13.578 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:29:13.584 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:29:13.586 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:29:13.607 +05:30 [INF] User found for Email: sujithkumar.kanini@outlook.com, UserId: 1010
2025-11-05 23:29:13.616 +05:30 [INF] Executing stored procedure sp_ValidateUserCredentials for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:29:13.633 +05:30 [INF] Credential validation result for Email: sujithkumar.kanini@outlook.com - false
2025-11-05 23:29:13.784 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedBy], [u].[CreatedOn], [u].[DeletedBy], [u].[DeletedOn], [u].[Email], [u].[FailedLoginAttempts], [u].[IsActive], [u].[IsDeleted], [u].[IsEmailVerified], [u].[LastLogin], [u].[LockoutEnd], [u].[PasswordHash], [u].[Phone], [u].[Role], [u].[TenantId], [u].[UpdatedBy], [u].[UpdatedOn]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS BIT) AND [u].[UserId] = @__p_0
2025-11-05 23:29:13.868 +05:30 [INF] Executed DbCommand (76ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FailedLoginAttempts] = @p0, [UpdatedOn] = @p1
OUTPUT 1
WHERE [UserId] = @p2;
2025-11-05 23:29:13.874 +05:30 [WRN] Login failed: Invalid credentials
2025-11-05 23:29:13.880 +05:30 [ERR] Login failed: Invalid email or password
2025-11-05 23:29:13.882 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 23:29:13.884 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api) in 327.0944ms
2025-11-05 23:29:13.887 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:29:13.889 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/login - 400 null application/json; charset=utf-8 408.5571ms
2025-11-05 23:31:09.492 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/login - application/json 73
2025-11-05 23:31:09.501 +05:30 [INF] CORS policy execution successful.
2025-11-05 23:31:09.517 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:31:09.521 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Kanini.Ecommerce.Application.DTOs.LoginRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 23:31:09.537 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:31:09.539 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:31:09.541 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:31:09.556 +05:30 [INF] User found for Email: sujithkumar.kanini@outlook.com, UserId: 1010
2025-11-05 23:31:09.563 +05:30 [INF] Executing stored procedure sp_ValidateUserCredentials for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:31:09.571 +05:30 [INF] Credential validation result for Email: sujithkumar.kanini@outlook.com - false
2025-11-05 23:31:09.583 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedBy], [u].[CreatedOn], [u].[DeletedBy], [u].[DeletedOn], [u].[Email], [u].[FailedLoginAttempts], [u].[IsActive], [u].[IsDeleted], [u].[IsEmailVerified], [u].[LastLogin], [u].[LockoutEnd], [u].[PasswordHash], [u].[Phone], [u].[Role], [u].[TenantId], [u].[UpdatedBy], [u].[UpdatedOn]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS BIT) AND [u].[UserId] = @__p_0
2025-11-05 23:31:09.602 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FailedLoginAttempts] = @p0, [UpdatedOn] = @p1
OUTPUT 1
WHERE [UserId] = @p2;
2025-11-05 23:31:09.612 +05:30 [WRN] Login failed: Invalid credentials
2025-11-05 23:31:09.617 +05:30 [ERR] Login failed: Invalid email or password
2025-11-05 23:31:09.620 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Kanini.Ecommerce.Common.Error'.
2025-11-05 23:31:09.623 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api) in 88.5165ms
2025-11-05 23:31:09.628 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:31:09.631 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/login - 400 null application/json; charset=utf-8 139.4548ms
2025-11-05 23:33:21.393 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5108/api/Auth/login - application/json 73
2025-11-05 23:33:21.406 +05:30 [INF] CORS policy execution successful.
2025-11-05 23:33:21.416 +05:30 [INF] Executing endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:33:21.429 +05:30 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Kanini.Ecommerce.Application.DTOs.LoginRequestDto) on controller Kanini.Ecommerce.Api.Controllers.AuthController (Kanini.Ecommerce.Api).
2025-11-05 23:33:21.440 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:33:21.445 +05:30 [INF] Login attempt started for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:33:21.449 +05:30 [INF] Executing stored procedure sp_GetUserByEmail for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:33:21.504 +05:30 [INF] User found for Email: sujithkumar.kanini@outlook.com, UserId: 1010
2025-11-05 23:33:21.506 +05:30 [INF] Executing stored procedure sp_ValidateUserCredentials for Email: sujithkumar.kanini@outlook.com
2025-11-05 23:33:21.525 +05:30 [INF] Credential validation result for Email: sujithkumar.kanini@outlook.com - true
2025-11-05 23:33:21.556 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedBy], [u].[CreatedOn], [u].[DeletedBy], [u].[DeletedOn], [u].[Email], [u].[FailedLoginAttempts], [u].[IsActive], [u].[IsDeleted], [u].[IsEmailVerified], [u].[LastLogin], [u].[LockoutEnd], [u].[PasswordHash], [u].[Phone], [u].[Role], [u].[TenantId], [u].[UpdatedBy], [u].[UpdatedOn]
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS BIT) AND [u].[UserId] = @__p_0
2025-11-05 23:33:21.610 +05:30 [INF] Executed DbCommand (48ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [FailedLoginAttempts] = @p0, [UpdatedOn] = @p1
OUTPUT 1
WHERE [UserId] = @p2;
2025-11-05 23:33:21.912 +05:30 [INF] Creating refresh token for UserId: 1010
2025-11-05 23:33:22.510 +05:30 [INF] Executed DbCommand (383ms) [Parameters=[@p0='?' (Size = 100), @p1='?' (DbType = DateTime2), @p2='?' (Size = 100), @p3='?' (DbType = DateTime2), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 100), @p8='?' (Size = 200), @p9='?' (Size = 100), @p10='?' (Size = 500), @p11='?' (Size = 100), @p12='?' (DbType = DateTime2), @p13='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [RefreshTokens] ([CreatedBy], [CreatedOn], [DeletedBy], [DeletedOn], [ExpiresAt], [IsDeleted], [RevokedAt], [RevokedBy], [RevokedReason], [TenantId], [Token], [UpdatedBy], [UpdatedOn], [UserId])
OUTPUT INSERTED.[RefreshTokenId], INSERTED.[IsRevoked]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-11-05 23:33:22.546 +05:30 [INF] Refresh token created successfully with Id: 1
2025-11-05 23:33:22.586 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [LastLogin] = @p0, [UpdatedOn] = @p1
OUTPUT 1
WHERE [UserId] = @p2;
2025-11-05 23:33:22.596 +05:30 [INF] Login successful for UserId: 1010
2025-11-05 23:33:22.601 +05:30 [INF] Login successful for UserId: 1010
2025-11-05 23:33:22.605 +05:30 [INF] Executing OkObjectResult, writing value of type 'Kanini.Ecommerce.Application.DTOs.LoginResponseDto'.
2025-11-05 23:33:22.656 +05:30 [INF] Executed action Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api) in 1217.2886ms
2025-11-05 23:33:22.659 +05:30 [INF] Executed endpoint 'Kanini.Ecommerce.Api.Controllers.AuthController.Login (Kanini.Ecommerce.Api)'
2025-11-05 23:33:22.662 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5108/api/Auth/login - 200 null application/json; charset=utf-8 1268.8104ms
2025-11-05 23:35:45.243 +05:30 [INF] Application is shutting down...
